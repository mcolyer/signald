#!/usr/bin/env ruby

require "rubygems"
require "bundler/setup"
require "optparse"
require "posix_mq"
require "json"

require_relative "../signals/base"

options = {}
OptionParser.new do |opts|
  opts.banner = "Usage: signald-send -n signal -v true"

  opts.on("-nNAME", "--name=NAME", "Specify the signal's name") do |v|
    options[:name] = v
  end

  opts.on("-vVALUE", "--value=VALUE", "Specify the signal's value") do |v|
    if v == "true"
      options[:value] = true
    else
      options[:value] = false
    end
  end
end.parse!

class CommandlineSignal < BaseSignal
  def initialize(name, signal)
    send_signal(name, signal)
  end
end

CommandlineSignal.new(options[:name], options[:value])
